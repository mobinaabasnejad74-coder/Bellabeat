-- Outliers
-- Heart rate invalid range
SELECT
  CASE
    WHEN Value < 30 THEN 'Below 30 (invalid)'
    WHEN Value BETWEEN 30 AND 59 THEN 'Low'
    WHEN Value BETWEEN 60 AND 100 THEN 'Normal'
    WHEN Value BETWEEN 101 AND 180 THEN 'High (activity)'
    ELSE 'Above 180 (extreme)'
  END AS heart_rate_range,
  COUNT(*) AS count
FROM `bellabeat-project-480011.bellabeat.heartrate_seconds`
GROUP BY heart_rate_range
ORDER BY count DESC;
-- there were 6 values more than 180 (extreme).

-- Steps invalid range
SELECT
 CASE
  WHEN Steps > 250 THEN 'Above 250 (invalid)'
  ELSE 'Valid'
 END AS steps_range,
 COUNT(*) AS count
FROM `bellabeat-project-480011.bellabeat.minute_steps`
GROUP BY steps_range
ORDER BY count DESC;
-- all values valid.

-- Hourly step invalid range
SELECT 
 CASE 
  WHEN StepTotal > 12000 THEN 'above 12000 (suspect/outlier)'
  WHEN StepTotal > 15000 THEN 'above 15000 (physically impossible)'
  ELSE 'valid'
 END AS step_total_range,
 COUNT(*) AS count
FROM bellabeat-project-480011.bellabeat.hourly_steps  GROUP BY step_total_range
ORDER BY count DESC;
-- all values valid.

-- Daily activity steps invalid range
SELECT
  CASE
    WHEN TotalSteps < 500 THEN 'Very Low (Likely not worn)'
    WHEN TotalSteps BETWEEN 500 AND 30000 THEN 'Typical Range'
    WHEN TotalSteps BETWEEN 30001 AND 50000 THEN 'Extreme Activity'
    WHEN TotalSteps > 50000 THEN 'Potential Outlier (>50k)'
  END AS activity_category,
  COUNT(*) AS record_count,
  ROUND(AVG(TotalSteps), 2) AS average_steps_in_group
FROM `bellabeat-project-480011.bellabeat.daily_activity`
GROUP BY activity_category
ORDER BY record_count DESC;
-- one extreme activity value found.

-- minute_MET invalid range
SELECT
 CASE
    WHEN METs < 10 THEN 'Below 10 (Physically Impossible)'
    WHEN METs > 200 THEN 'Above 200 (Extreme Outlier)'  ELSE 'valid'
 END AS METs_valid_range,
 COUNT (*) AS count
FROM `bellabeat-project-480011.bellabeat.minute_MET`
GROUP BY METs_valid_range
ORDER BY count DESC;
-- 14 valuse found under 10.

-- hourly_calories invalid range
SELECT
  CASE
    WHEN Calories = 0 THEN 'Zero Calories (Physically Impossible)'
    WHEN Calories < 30 THEN 'Below Typical BMR (<30 kcal)'
    WHEN Calories > 700 THEN 'Extreme Calorie Burn (>700 kcal)'
    ELSE 'Logical Range'
  END AS calorie_validity,
  COUNT(*) AS record_count
FROM `bellabeat-project-480011.bellabeat.hourly_calories`
GROUP BY calorie_validity
ORDER BY record_count DESC;
-- 12 values found over 700, extreme calorie burn.

-- minute_sleep invalid range
SELECT
  Id,

  EXTRACT(DATE FROM PARSE_TIMESTAMP('%m/%d/%Y %I:%M:%S %p', date)) AS sleep_date,
  
  ROUND(COUNTIF(value = 1) / 60, 2) AS total_sleep_hours, 
  
  CASE 
    WHEN COUNTIF(value = 1) / 60 < 2 THEN 'Under 2hrs (Short/Nap)'
    WHEN COUNTIF(value = 1) / 60 > 15 THEN 'Over 15hrs (Extreme Outlier)'
    ELSE 'Typical Sleep'
  END AS sleep_category
FROM `bellabeat-project-480011.bellabeat.minute_sleep`
WHERE value = 1 
GROUP BY Id, sleep_date
ORDER BY total_sleep_hours DESC;
-- 1 ID found wiht over 15 hours, outlier.

-- weight_loginfo
SELECT
  Id,
  BMI,
  Fat,
  CASE
    WHEN BMI < 10 OR BMI > 70 THEN 'BMI Outlier (Manual Entry Error)'
    WHEN Fat > 60 THEN 'Body Fat % Suspect (>60%)'
    WHEN Fat = 0 THEN 'Missing/Placeholder Fat Value'
    ELSE 'Logical Range'
  END AS weight_validity_check
FROM `bellabeat-project-480011.bellabeat.weight_loginfo`
ORDER BY BMI DESC;
-- all logical range. the Fat coloumn are all null.